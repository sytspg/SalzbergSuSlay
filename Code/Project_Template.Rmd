---
title: "The very basics of R"
subtitle: "https://github.com/sytspg/SalzbergSuSlay/"
author: "Josh Salzberg, Yitong Eric Su, and Sarah Slay"
date: "12/12/2025"
editor_options: 
  chunk_output_type: console
output:
  
  html_document:
    latex_engine: xelatex
    toc: true
    number_sections: true
---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set global options for R chunks
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE)

# Set your working directory
here()
getwd()

# Load your packages
library(tidyverse)
library(gridExtra)
library(knitr)
library(broom)
library(ggcorrplot)
library(visreg)
library(plotly)
library(ggrepel)
library(ggExtra)

# Set your ggplot theme
mytheme <- theme_classic(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "right")
theme_set(mytheme)

# Load your datasets
NCData <- read.csv(here('Data','Processed','NCDataClean.csv'),stringsAsFactors = T)

```


# Rationale and Research Questions

Background and rationale explanation.
The goal of our analysis is to determine whether household income is correlated with specific climate change indicators. Due to redlining and disenfranchisement, low-income households tend to be located in areas more vulnerable to climate change. Determining whether household income is correlated with indicators such as flood risk or heat index informs policy initiatives. For example, flood damage costs exceeded $53 billion after hurricane Helene (Thomae, 2024). If flood risk increases with low-income households, these vulnerable populations would bear the highest cost. Policies for floodplain buyouts should aim to reduce cost burden for low-income households. 
In addition, extreme heat exposure worsens chronic health conditions and can lead to premature death. Areas with lower socioeconomic status have limited access to resources such as health clinics that could address heatstroke symptoms (EPA, 2024). Therefore, if low-income households have a higher number of extreme heat days, they are more likely to suffer adverse effects. 

Lastly, we want to understand the distribution of climate change effects in NC. The varied topography and ecology of the state results in differing climate change impacts. Identifying counties with vulnerable populations will help decision-makers target policies to mitigate the effects of climate change.  


We focused our analysis at the county level in North Carolina. Data was obtained for median household income and population distribution of each county, as well as climate change indicators. This data was wrangled and analyzed to answer the following questions: 

1. Is household income correlated with walkability, flood risk, or heat index?
2. Are specific counties disproportionately at risk of climate change?

\newpage

# Dataset Information

The dataset describes household income and population for all 100 counties in NC as of . Each county has its own row and is associated with several climate change indicators: 
- Flood Hazard Area
- Daily Max Heat Index
- Walkability

Each indicator has its own column for a total of 14 columns. Most of the data was obtained from the   

\newpage

# Exploratory Analysis 

## Data Summary

Describe the parameters/indices, their distributions, and potential correlations.

\newpage

# Analysis

```{r}

p2<-ggplot(NCData, aes(Total.Population))+
  geom_histogram(fill="green", color="black", bins=20)+
  geom_boxplot(width=25)+
  labs(title="Total Population", x="Count")

p3 <- ggplot(NCData, aes(TotalHouseholds))+
  geom_histogram(fill="orange", color="black", bins=20)+
  geom_boxplot(width=200)+
  labs(title="Total Household Income", x="US Dollars")

p5<- ggplot(NCData, aes(AvgHHinc))+
  geom_histogram(fill="purple", color="black", bins=20)+
  geom_boxplot(width=50)+
  labs(title="Average Household Income", x="US Dollars")

#do we really need number of living rooms?
p4<-ggplot(NCData, aes(WalkIndexScore))+
  geom_histogram(fill="lightblue", color="black", bins=20)+
  geom_boxplot(width=50)+
  labs(x="living-dining rooms",title="Distribution of \nliving-dining rooms")

#what are we counting as amenities?
p6<-ggplot(NCData, aes(PercentPopInFHA))+
  geom_histogram(fill="lightgreen", color="black", bins=20)+
  geom_boxplot(width=25)+
  labs(x="Total amenities",title="Distribution of \ntotal amenities")
#IDK if we need rental price if we're looking at income
p1<-ggplot(NCData, aes(PercentPopInFHA))+
  geom_histogram(fill="pink", color="black", bins=20)+
  geom_boxplot(width=25)+
  labs(x="Rental price",title="Distribution of \nrental price")+
  theme(axis.text.x = element_text(angle=20, hjust=1))


grid.arrange(p1,p2,p3,p4,p5,p6,ncol=3)
```


```{r, out.width="70%"}
lane<-lane %>%
  mutate(log_rent=log(rent), log_square_meters=log(sqmeters), total_amenities=total_amens)
lane.subset <- lane %>% 
  select(c( log_rent, bedrooms, living.dining, bathrooms, log_square_meters, total_amenities))

testcors <- cor(lane.subset, use="complete.obs")
ggcorrplot(testcors,method="circle",type="lower", lab=TRUE, lab_size = 3.5, colors=c("#CCFFCC","white","orange"), title="Correlation plot of variables")

```


```{r, out.width="65%"}
lane<-lane%>%mutate(multi_use=case_when(use_type_en=="multi-use"~1, use_type_en=="residential"~0))
bathroomswo <- lane%>%filter(bathrooms<15, sqmeters>1)
p6<- ggplot(bathroomswo, aes(log(sqmeters), log(rent)))+
  geom_jitter()+
  geom_smooth( method="lm", formula=y~x, se=FALSE)+
  labs(title="Relationship between log(square \n meters) and log(rental price)", x="log(square meters)")

p7<- ggplot(lane, aes(bedrooms, log(rent)))+
  geom_point(position="jitter")+
  geom_smooth( method="lm", formula=y~x, se=FALSE)+
  labs(title="Relationship between number \nof bedrooms and log(rental price)", x="bedrooms number")

grid.arrange(p6,p7,ncol=2)
```


## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References (APA)

Environmental Protection Agency. (2024). Climate Change and the Health of Socially Vulnerable People. EPA. https://www.epa.gov/climateimpacts/climate-change-and-health-socially-vulnerable-people 

Thomae, L. (2024, December 3). Helene damage costs in NC more than $53 billion. who will pay is unclear. Carolina Public Press. https://carolinapublicpress.org/67325/helene-costs-nc-billions-unclear-who-pays/ 

