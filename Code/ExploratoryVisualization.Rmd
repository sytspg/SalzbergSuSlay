---
title: "ExploratoryVisualization"
author: "jhs"
date: "2025-12-09"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

We will begin exploring our county data to understand the distributions and tendencies. To do so, we must set up our workspace with relevant packages and import our processed data.

```{r setup, echo=TRUE, include=FALSE}
#install.packages(tidyverse);install.packages(here);install.packages(ggthemes)
library(tidyverse)
library(here)
library(ggthemes)
library(scales)
here()
NCData <- read.csv(here('Data','Processed','NCDataClean.csv'),stringsAsFactors = T)

my_theme <- theme_calc()  + 
  theme(
    #line =              element_line(),
    #rect =              element_rect(),
    text =              element_text(family="mono"),
    
    # Modified inheritance structure of text element
    #plot.title =        element_text(),
    #axis.title.x =      element_blank(),
    #axis.title.y =      element_blank(),
    #axis.text =         element_text(),
    
    # Modified inheritance structure of line element
    #axis.ticks =        element_line(),
    #panel.grid.major =  element_line(),
    #panel.grid.minor =  element_blank(),
    
    # Modified inheritance structure of rect element
    #plot.background =   element_rect(color =),
    #panel.background =  element_rect(),
    #legend.key =        element_rect(),
    
    # Modifiying legend.position
    #legend.position = 'right',
    
    #complete = TRUE
    )

```

With our data loaded, we can begin to explore the distributions and tendencies of our data.

Calling the summary function on the data reveals the basic dimensions of the data: minimum, quartiles, median, mean and maximum.

```{r}
summary(NCData)
```

We can see right off the bat that the difference in population between the smallest and largest count is about a factor of 1,000. We can assume the distribution of counts of population is right skewed because the mean is larger than the median. The graph, figure 1 below, proves this visually.

```{r, echo=FALSE}
PopPlot <- ggplot(data = NCData)+
  stat_bin(aes(x= Total.Population), binwidth=20000)+
  labs(title = "Fig 1: Total Population Distribution",
       subtitle = "Right Skew Confirmed; Bin Width = 20,000",
       x = "Total Population",
       y = "Number of Counties")+
  scale_x_continuous(labels = comma, breaks=breaks_pretty(8))+
  my_theme
  
PopPlot
```

Household incomes do not demonstrate the same magnitude in range: the minimum average household income of the counties is about a third of the maximum average household income. In the case of median household incomes, the difference is much smaller, and is less influenced by the largest incomes in each county.

```{r, echo=FALSE}
IncomePlot <- ggplot(data = NCData)+
  geom_histogram(aes(x=AvgHHinc), fill="red", alpha=0.5)+
  geom_vline(xintercept=97676, linetype='dashed', 
             color='red', linewidth=1)+
  geom_histogram(aes(x=MedHHinc), fill="blue", alpha=0.5)+
  geom_vline(xintercept=77228, linetype='dashed', 
             color='blue', linewidth=1)+
  labs(title = "Fig. 2: Average and Median Household Income Distributions",
       subtitle = "Red = Average, Blue = Median \nVertical lines represent distribution's average",
       x = "Household Income",
       y = "Number of Counties")+
  scale_x_continuous(labels = dollar,
                     breaks=breaks_pretty(6))+
  my_theme

IncomePlot
```

Walkability Index Scores and percentages of residents in different designations of walkability imply that walkability across the state is low; it appears a significant proportion of counties have well over half their population residing in "least walkable" and "below average walkable" conditions. Further, a vast majority of counties have no "most walkable" conditions.

```{r, echo=FALSE}
library(cowplot)

LeastWalkPlot <- ggplot(NCData, 
                        aes(x = LeastWalk))+
  geom_histogram(stat='bin',fill="lightblue")+
  labs(x="% Residents in \nLeast Walkable Conditions",
       y="# of Counties")+
  scale_x_continuous(labels=percent, limits = c(-.05,1))+
  scale_y_continuous(limits= c(-0.05,100))+
  my_theme

BelowAvgWalkPlot <- ggplot(NCData, 
                           aes(BelowAvgWalk))+
  geom_histogram(stat='bin',fill="lightblue")+
  labs(x="% Residents in \nBelow Average Walkable Conditions",
       y="# of Counties")+
  scale_x_continuous(labels=percent, limits = c(-.05,1))+
  scale_y_continuous(limits= c(-0.05,100))+
  my_theme

AboveAvgWalkPlot <- ggplot(NCData, 
                           aes(AboveAvgWalk))+
  geom_histogram(stat='bin',fill="lightblue")+
  labs(x="% Residents in \nAbove Average Walkable Conditions",
       y="# of Counties")+
  scale_x_continuous(labels=percent, limits = c(-.05,1))+
  scale_y_continuous(limits= c(-0.05,100))+
  my_theme


MostWalkPlot <- ggplot(NCData, 
                       aes(MostWalk))+
  geom_histogram(stat='bin',fill="lightblue")+
  labs(x="% Residents in \nMost Walkable Conditions",
       y="# of Counties")+
  scale_x_continuous(labels=percent, limits = c(-.05,1))+
  scale_y_continuous(limits= c(-0.05,100))+
  my_theme

plot_grid(LeastWalkPlot,
          BelowAvgWalkPlot,
          AboveAvgWalkPlot,
          MostWalkPlot, 
          align = 'hv',
          axis = 'tblr',
          labels = "AUTO")
```

Reassuringly, we see that approximately three quarters of counties in North Carolina have below 10% of their population living within Flood Hazard Areas. However, one country is living with approximately 94.5% of its population in Flood Hazard Areas.

```{r, echo=FALSE}
ResidentsinFHA <- ggplot(NCData, aes(PercentPopInFHA))+
  geom_histogram(stat = 'bin', fill="lightblue")+
  labs(title= "Fig 4: Percent of Residents in Flood Hazard Areas",
       x="% Residents in Flood Hazard Area",
       y="# of Counties")+
  my_theme
ResidentsinFHA
```

Lastly, we explore how the count of days over the county's 95th percentile Heat Index is distributed across the state. We can see that the data approximates a normal distribution, but further analysis would be required to confirm the goodness of fit, especially given the slightly off-center mode.

```{r, echo=FALSE}
DMHIPlot <- ggplot(NCData, aes(DailyMaxHeatIndex95Percentile))+
  geom_histogram(binwidth = 1, fill="lightblue")+
  labs(title = "Fig 5: Count of 95th Percentile Daily Max Heat Index",
       x="Number of Days over 95th Percentile",
       y="# of Counties")+
  scale_x_continuous(breaks=seq(5,17), limit = c(5,17))+
  my_theme
DMHIPlot
```
